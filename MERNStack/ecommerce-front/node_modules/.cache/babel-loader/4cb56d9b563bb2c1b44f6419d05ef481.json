{"ast":null,"code":"var _jsxFileName = \"/Users/swagath/Desktop/MERN Stack Ecommerce/MERN-Stack-Ecommerce-App-with-Braintree-Payment-Integration/ecommerce-front/src/core/Checkout.js\";\nimport React, { useState, useEffect } from 'react';\nimport Card from './Card';\nimport { Link } from 'react-router-dom';\nimport { getProducts, getBraintreeClientToken } from './apiCore';\nimport { isAuthenticated } from '../auth';\nimport DropIn from 'braintree-web-drop-in-react';\n\nconst Checkout = ({\n  products\n}) => {\n  const [data, setData] = useState({\n    loading: false,\n    success: false,\n    clientToken: null,\n    error: '',\n    instance: {},\n    address: ''\n  });\n\n  const userId = isAuthenticated() && isAuthenticated().user._id;\n\n  const token = isAuthenticated() && isAuthenticated().token;\n\n  const getToken = (userId, token) => {\n    getBraintreeClientToken(userId, token).then(data => {\n      if (data.error) {\n        console.log(data.error);\n        setData({ ...data,\n          error: data.error\n        });\n      } else {\n        console.log(data);\n        setData({\n          clientToken: data.clientToken\n        });\n      }\n    });\n  };\n\n  useEffect(() => {\n    getToken(userId, token);\n  }, []);\n\n  const buy = () => {\n    //setData({ loading: true });\n    // send the nonce to your server\n    // nonce = data.instance.requestPaymentMethod()\n    let nonce;\n    let getNonce = data.instance.requestPaymentMethod().then(data => {\n      console.log(data);\n      nonce = data.nonce; //once you have nonce (card type, card number) send nonce as 'paymentMethodNonce'\n      //and also total to be charged\n\n      console.log(\"send nonce and total to process: \", nonce, getTotal(products));\n    }).catch(error => {\n      // console.log(\"dropin error: \", error);\n      setData({ ...data,\n        error: error.message\n      });\n    });\n  };\n\n  const showDropIn = () => /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }\n  }, data.clientToken !== null && products.length > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(DropIn, {\n    options: {\n      authorization: data.clientToken\n    },\n    onInstance: instance => data.instance = instance,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: \"{buy}\",\n    className: \"btn btn-success btn-block\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 21\n    }\n  }, \"Pay\")) : null);\n\n  const getTotal = () => {\n    return products.reduce((currentValue, nextValue) => {\n      return currentValue + nextValue.count * nextValue.price;\n    }, 0);\n  };\n\n  const showCheckout = () => {\n    return isAuthenticated() ? /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }\n    }, showDropIn()) : /*#__PURE__*/React.createElement(Link, {\n      to: \"/signin\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 17\n      }\n    }, \"Sign in to checkout\"));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 12\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 16\n    }\n  }, \"Total: $\", getTotal(), \" \"), showCheckout());\n};\n\nexport default Checkout;","map":{"version":3,"sources":["/Users/swagath/Desktop/MERN Stack Ecommerce/MERN-Stack-Ecommerce-App-with-Braintree-Payment-Integration/ecommerce-front/src/core/Checkout.js"],"names":["React","useState","useEffect","Card","Link","getProducts","getBraintreeClientToken","isAuthenticated","DropIn","Checkout","products","data","setData","loading","success","clientToken","error","instance","address","userId","user","_id","token","getToken","then","console","log","buy","nonce","getNonce","requestPaymentMethod","getTotal","catch","message","showDropIn","length","authorization","reduce","currentValue","nextValue","count","price","showCheckout"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Card from './Card';\nimport { Link } from 'react-router-dom';\nimport { getProducts, getBraintreeClientToken } from './apiCore';\nimport { isAuthenticated } from '../auth';\nimport DropIn from 'braintree-web-drop-in-react';\n\nconst Checkout = ({products}) => {\n\n  const [data, setData] = useState({\n        loading: false,\n        success: false,\n        clientToken: null,\n        error: '',\n        instance: {},\n        address: ''\n    });\n\n\n    const userId = isAuthenticated() && isAuthenticated().user._id;\n    const token = isAuthenticated() && isAuthenticated().token;\n\n    const getToken = (userId, token) => {\n        getBraintreeClientToken(userId, token).then(data => {\n            if (data.error) {\n                console.log(data.error);\n                setData({ ...data, error: data.error });\n            } else {\n                console.log(data);\n                setData({ clientToken: data.clientToken });\n            }\n        });\n    };\n\n    useEffect(() => {\n        getToken(userId, token);\n    }, []);\n\n  \n    const buy = () => {\n        //setData({ loading: true });\n        // send the nonce to your server\n        // nonce = data.instance.requestPaymentMethod()\n        let nonce;\n        let getNonce = data.instance\n            .requestPaymentMethod()\n            .then(data => {\n                 console.log(data);\n                nonce = data.nonce;\n                //once you have nonce (card type, card number) send nonce as 'paymentMethodNonce'\n                //and also total to be charged\n                console.log(\n                    \"send nonce and total to process: \",\n                    nonce,\n                    getTotal(products)\n                );\n\n            })\n            .catch(error => {\n                // console.log(\"dropin error: \", error);\n                setData({ ...data, error: error.message });\n            });\n    };\n    \n\n   const showDropIn = () => (\n        <div >\n            {data.clientToken !== null && products.length > 0 ? (\n                <div>\n                \n                    <DropIn\n                        options={{\n                            authorization: data.clientToken\n                        }}\n                        onInstance={instance => (data.instance = instance)}\n                    />\n                    <button onClick=\"{buy}\" className=\"btn btn-success btn-block\">\n                        Pay\n                    </button>\n                </div>\n            ) : null}\n        </div>\n    );\n\n\t const getTotal = () => {\n\t \t return products.reduce((currentValue, nextValue) => {\n\t \t \treturn currentValue + nextValue.count * nextValue.price;\n\t \t },0);\n\t }\n\n\t const showCheckout = () => {\n        return isAuthenticated() ? (\n            <div>{showDropIn()}</div>\n        ) : (\n            <Link to=\"/signin\">\n                <button className=\"btn btn-primary\">Sign in to checkout</button>\n            </Link>\n        );\n    }\n\n      return (\n           \n           <div>\n               <h2>Total: ${getTotal()} </h2>\n               {showCheckout()}\n           </div>\n      \t)\n \n};\n\nexport default Checkout;\n"]},"metadata":{},"sourceType":"module"}